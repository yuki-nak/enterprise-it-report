# 社内情報システム部門の課題と展望

## 現状課題
情報システム部門の目的は「システムの安定稼働」「生産性向上」「情報資産の保護」、そしてこの三つを達成するための「IT投資効果の最大化」この４つと考えます。
しかしこの４つが今守れない危機的な状況にあります。理由は以下のとおりです。

### 1. システムの安定稼働 

**老朽化したインフラ**: 長年使用しているハードウェアやソフトウェアの老朽化によりパフォーマンス低下および障害が多発。またサポート期限が切れているものについては不具合が発生しても対処できない。  

**複雑なシステム構成**: 多くのシステム導入およびその後の環境変化に合わせて改修や機能追加によりシステムが複雑に絡み合い、問題の特定と解決が困難な状況が常態化。  

**技術者不足**: 専門的な知識、経験を持つ技術者が不足しており、メンテナンスやトラブルシューティングが迅速に行えない。  


### 2. 業務生産性向上

**レガシーシステムの存在**: 古いシステムが残存しているため、新しい技術やツールの導入が進まず、業務の効率化が図れない。  

**社員のITリテラシーの低さ**: 社員が新しいシステムやツールを使いこなせず、十分な生産性向上が見込めない。  

**コミュニケーションの不足**: 情報システム部門と他の部署との連携が不十分で、業務プロセスの改善に向けた具体的な取り組みが進んでいない。  

### 3. 情報資産の保護

**セキュリティ対策の遅れ**: サイバー攻撃の増加に対して、適切なセキュリティ対策が追いついておらず、データの漏洩リスクが高まっている。  

**データガバナンスの欠如**: 特に監査外のデータの管理体制が整備されておらず、データの一貫性や正確性が保証されていない。  

**法規制への対応不足**: 個人情報保護法やGDPR(EU一般データ保護規則)など、データに関する法規制への対応が不十分で、コンプライアンスリスクが存在する。  

  
### 4. IT投資効果の最大化

**ベンダ丸投げ**： ITによる解決策を見出せず、要件定義からベンダやコンサルタントに丸投げして依存関係とブラックボックス化が発生。  

**誤った投資評価**: 投資に対する評価能力がなく、トレンドやコンサルタントの言葉を鵜呑みにして実態に合わない投資の発生。  

**プロジェクト管理能力の不足**： 能力的または時間的問題からベンダコントロールができず想定外の費用が発生。


見て分かる通りそれぞれの課題はシステムの **「古さ」「複雑さ」「扱う人」** に起因します。
これらリスクは最終的にハードウェア故障やサイバー攻撃による事業停止を招きます。運良くそれらを全て免れたとしても、低い生産性を起因とした深刻な人手不足、更なる退職者の増加のループに落入ります。
従って課題解決するためにレガシーシステムの刷新は待ったなしです。もちろんただ刷新すればいいわけではありません。現代のITテクノロジーと自社の業務特性を理解した上で新たなシステムアーキテクチャ像の策定とそれに向かうための投資計画を定める必要があります。これこそがDXのスタートとなります。
注意すべきは、この構想段階から社外コンサルタントに依頼するとベンダーロックインとなる提案がなされ身動きの取れない搾取構造が生まれるリスクがあります。当然ではありますが、アーキテクチャと投資計画は経営陣並びに社内IT部門がオーナーシップを持たなくてはなりません。


## システムアーキテクチャ方針
### 事業の永続化を実現するIT環境の実現

    - 安定稼働するシステム
      - パッケージシステムの採用
      - 重要処理の見える化と極小化
      - システムメンテナンスの定期実施
      - 高可用性と冗長性の確保

    - 環境の変化に対応可するシステム
      - システム間の疎結合化
      - ERP中心主義からの脱却
      - API活用による内外連携強化
      - クラウドサービスの積極活用
  
  
    - 生産性の高い稼げるシステム
      - ROIに基づく投資計画と実行
      - データの見える化と再利用化
      - モバイルフレンドリーなシステムの導入
      - 業務プロセスの自動化
  
    - リスクベースの情報資産管理
      - 多層防御のセキュリティ強化対策
      - 定期的なセキュリティ診断と対策
      - インシデント対応計画の策定と実行
      - 社員教育と意識向上プログラムの実施

  

ではこれらを実現するための具体的な方法を示します。

## 周辺システムの更新

### ターゲット選定
ERP更新待ったなしの状況ではすぐにシステムの刷新に取り掛かる必要があります。繰り返しますがERPと周辺システムを同じに更新することは悲劇を招きます。
なので周辺システムから始め、徐々にERPが果たす役割を削ぎ落としていきます。そしてERPの担う役割が十分に小さくなったところで切り替えを行います。
ここで注意が必要なのが周辺システムを更新してもレガシーERPのインタフェースとして古いシステムが残る可能性はあります。コストは掛かりますが安全な切り替えには並行稼働が一番なのです。

では具体的にどの周辺システムから手をつけるべきか。特に業務上深刻な悩みを抱えているシステムがあればそこから手をつけるべきです。得てしてそういった問題システムは複雑で更新が難しいものですが、最初にチャレンジすべきか他のシステムから地固めをして望むかはIT部門だけでなく組織として合意する必要があります。

もし決めかねているようであればビジネスの上流、つまり見積システムや受注システムから始めることをお勧めします。ビジネスロジックは企業によって千差万別ですが上流の方が定型的なプロセスが多く、また後続の在庫システムや生産計画システムへ整備されたデータが流れるので切り替えがしやすくなります。

逆に難しいのがERPを通した後のシステム更新です。統合ERPとの結合が強く、業務プロセスもそれに依存しているためより大きな変化となります。またデータウェアハウスやBIツールレポート系のシステムは後回しです。ビジネス（キャッシュ）は残高を基軸としたイベント（トランザクション）の連続により流れます。イベントにより受注が発生し、在庫引当てされ、生産計画から製造が行われ、出荷され売掛金回収があります。経営者が眺めるレポートはこれらイベントで発生したデータの断面であり、直接利益もデータも生みません。レポート業務は多大な時間を要するので真っ先に変えたいのは理解できますが、まずはビジネスの根幹であるイベントデータを整理し、質の高いものにすることが後のレポート生成に役立ちます。またレポートはレポートが単純な２次元のテーブルでなく多面的なテーブルで表現されるため、生成するSQLが複雑になったり、RDBでは表現できない部分を手作業でカバーする必要があります。多次元データベースはレポート生成を前提としたデータベースで、データウェアハウスにも採用されます。多次元データベースを導入することでエンドユーザーがレポートを作りやすい環境を提供することができます。


### 現状分析と次期帳票作成

企画フェーズにおける成果物は以下のとおりです。見てわかるとおり企画段階で外部設計まで行います。

- 費用対効果試算表
- データフローダイアグラム (DFD)
- 論理データモデル図
- 機能要件一覧


システム更新にあたり現状分析は当然行いますが、業務プロセスのフローチャートを作って、その中で必要な機能を抽出して終わり、というパターンがとても多いです。これは分析とは言えません。
ターゲットが決まったらまずそのシステムにどれだけのコストが掛かっているかの計算に取り組みます。コストはソフトウェア保守費や運用管理者の人件費だけでなく、スタッフがそのシステムにどのくらい向き合っているか、例えば受注データの確認や在庫引当て作業に何分要しているかまで確認します。これがROI(投資対効果)を算出するベースとなり、システム更新に掛けてよい予算が見えてきます。要件定義を終え、ベンダ出された見積をベースに予算組や機能削減などの帳尻合わせに走るのは悪手です。常にROIをベースに要件と予算を定める必要があります。  

費用対効果試算表を作りながら業務ユーザにヒアリングする軸となるは「帳票の中身であるデータ」です。これが論理データモデル図になります。業務プロセスは全く業務知識が無い際にざっとヒアリングする程度でよいです。帳票は顧客から受取る注文書だったり、システムの受注明細確認メニューだったり様々です。これら帳票を見ながら各データが持つ意味と発生元（インプット）、と利用先（アウトプット）を１つ１つ確認していきます。これによりDFDが作られます。ちなみにここまでヒアリングできれば副産物として業務フロー図を作ることも可能です。時間がなければ現状のレビューは早々に目指すべき帳票を作ることに注力してください。

機能要件一覧は実装の優先度、重み付けを行います。ここでも繰り返しますが、残高処理とレポートは分けてください。そして残高処理を優先してください。レポート機能や重要でない機能はは後から徐々に追加していけばいいのです。この機能ごとサービスと考え分割する設計手法はサービス指向アーキテクチャ(SOA)と呼ばれ、システムの疎結合化と早期リリースを実現します。

### パッケージ検討

ここまでROIのコスト算出と現状分析を兼ねた次期帳票作成を説明しました。この次期帳票作成の終わりが見えてきたら、果たして目指すべきシステムがパッケージで実現できるか検討に入ります。方針でも触れていますが、安定した外部ベンダーパッケージが導入できれば実装のスピード、コストだけでなくセキュリティ対策やバックアップなど運用面でのコスト削減が見込めます。可能であれば妥協や業務プロセスを変更してでもパッケージを使うことを切に願います。統合型ERPの導入による破壊的変更に比べれば軽微な業務プロセス変更で済むからです。一方で「ここは会社に利益をもたらす上で絶対に外せない」というポイントがある場合は運用コストを考慮の上、内製アプリ開発を行います。


### 企画フェーズその他

今回主眼としていませんが、この段階で重要なのがプロジェクトの組織体制作りです。ステークホルダーを整理し、キーマンをアサインする。ERP更新のような巨大プロジェクトでは現行システムを維持するチームと新規導入を担うチームに分けることが一般的です。現行システムの保守をしながら新しい企画を考えるのはリソース的に困難です。また新規導入を担うチームは新しいテクノロジーをよく理解するメンバーで構成する必要があります。そして現行維持チームと新規導入チームは新旧システムのインタフェース開発で連携し、協働していく必要があります。


## アーキテクチャ設計

企画フェーズの成果物が出揃ったらアーキテクチャの設計に入ります。ここではフルスクラッチで作るのか、パッケージ＋小規模なサブシステムで構成するか、などケースによって様々です。ここでシステムアーキテクチャ方針に立ち帰り設計を行います。

### 統合データハブの設計

論理データモデル図を確認し、他システムに流れるデータについては周辺システムと異なる統合データハブとなるデータベースを経由して共有します。統合データハブは複数のシステムで利用される重要データの集約場所です。データハブに保存するデータはイベント(トランザクション)データとリソース(マスタ)データを物理的に分けます。大容量でリアルタイム性が求められる在庫データについては別のデータハブとして構築しても良いかもしれません。データハブにデータを送る際はData SpiderなどのETLツールを利用すると実装負荷が減ります。統合データベースはストアドプロシージャを使いません。これはデータベースの移行容易性を担保するものです。あくまで静的データの保存先なのでデータ処理のため中間テーブルを作ることは無いはずです(周辺システムのDBでは当然あります)。データ変換プログラムを用いる場合、データハブ本体に置いても、その前面に統合APIサーバを置いても構いません。データハブに送るイベントデータは非正規化する必要が出てきます。マスタデータの変更や削除によって過去データの改ざん、遺失を避けるためです。周辺DBからデータハブへデータを送るタイミングは適材適所になります。リアルタイム性が求められる場合はイベント検知によって非同期で処理を行います。これは何でもかんでも「夜間バッチ」で処理しようとして結果重要処理のピタゴラスイッチを避ける意味でも効果的です。ただ非同期処理はデータの整合性を担保するために考慮すべき事項も夜間バッチに比べ多いのも事実です。いずれのケースも仮にエラーが発生した際など再処理の結果が保証される「冪等性」が求められます。

### MDMの設計

イベントの結果である残高データが最も重要と述べました。マスタはその残高データの品質と利用効率を高めるための副産物と考えます。複数システムで共有されるマスタデータも各周辺システムで管理のでなく、マスタデータ管理(MDM)システムを活用し、統合的に管理します。しかしマスタデータ管理を厳密に行いすぎるとマスタデータを介したシステム間の密結合が起こり得ません。無理して統合せずにインタフェースプログラムで名寄せをすることで弾力性のあるシステムが実現できます。


### 改めてシステムアーキテクチャ

統合的な入出力場所ではるデータハブの構想ができたら実際のアプリケーションを中心にしたシステム設計です。実行インフラについては柔軟性と多様な機能を持つクラウドをファーストターゲットに置きます。クラウドはコスト試算もしやすいのがメリットです。構成はAWSでいうとコンピューティングにEC2、Lambda、ストレージにEBSやS3など提供されるサービスの中から選択します。コンピューティングにコンテナを使うのは開発面では便利かもしれませんが管理の煩雑さ、VMに比べ実行環境がプラットフォーム依存になりやすい、加えてユーザ数が限られ並列処理を多く求めないエンタープライズ環境では真っ先に考えなくてよいかと考えます(私の知識や経験不足が多分にあります)
PaaSの利用検討も必要です。RDSはデータベース管理の多くから解放されますが、コンテナ同様プラットフォーム依存になります。特にミッションクリティカルなデータベースはBCPを視野に入れ、別環境でもデータリカバリができる構成を検討する必要があります。

またシステムアーキテクチャを考える上でセキュリティは必須です。利用者に社外ユーザが含まれる場合は一層の防御を考えないといけません。例えば二層のサーバ、データベースシステムでなく、APIサーバを挟んだ三層構造を構えHTTPSベースでの通信を検討します。

セキュリティや可用性を追求するといくら時間とお金があっても足りません。投資対効果と扱うデータのプライオリティを勘案して妥結することになります。


### 内部設計

外部設計は企画フェーズの成果物で一通り完成しているはずです。ここまではIT部門のタスクですが、内部設計および開発は外部ベンダーに依頼するのが一般的です。しかしこのフェーズでも丸投げせずに開発のための枠組は開発者と議論し決めるべきだと考えます。例えば開発者が得意なマイナー言語を使われるとその後の保守コストが大きく変わります。一般的なエンタープライズシステムでは開発者人口の多い言語、今もアップデートがなされ枯れた言語を選定すべきです。フレームワークも同様です。変更点管理としてGitなどのバージョン管理ツールは使います。またこれまで何度も言及した疎結合化のためにクリーンアーキテクチャ、MVCアーキテクチャなどレイヤードアーキテクチャを勧めて変更容易性をアプリケーションレベルで担保することも重要です。コードレビューにも顔を出しアプリケーションの理解を深め、方針と実装が乖離していないかすり合わせを行います。